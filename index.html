<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>L·ªãch tr√¨nh ƒëi ch∆°i c·ªßa ch√∫ng ta üíï</title>
  <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/833/833472.png">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      /* Remove mobile tap highlights globally */
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
    }

    /* Additional mobile tap highlight removal */
    button, input, textarea, select, a, div {
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
    }

    body {
      font-family: 'Nunito', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      min-height: 100vh;
      padding: 20px;
      position: relative;
      overflow-x: hidden;
    }

    /* Animated background particles */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image:
        radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 40% 20%, rgba(255, 255, 255, 0.05) 0%, transparent 50%);
      animation: particleMove 20s ease-in-out infinite;
      pointer-events: none;
      z-index: 0;
    }

    @keyframes particleMove {
      0%, 100% { transform: translate(0, 0); }
      33% { transform: translate(30px, -30px); }
      66% { transform: translate(-20px, 20px); }
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.98);
      border-radius: 30px;
      box-shadow: 0 25px 60px rgba(102, 126, 234, 0.4);
      overflow: hidden;
      backdrop-filter: blur(15px);
      position: relative;
      z-index: 1;
      animation: slideInUp 0.8s ease-out;
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 35px 20px;
      text-align: center;
      color: white;
      position: relative;
      overflow: hidden;
    }

    .header::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
      animation: headerGlow 8s ease-in-out infinite;
    }

    @keyframes headerGlow {
      0%, 100% { transform: translate(0, 0); }
      50% { transform: translate(10%, 10%); }
    }

    .header::before {
      content: 'üå∏‚ú®üé¨‚ú®üå∏';
      position: absolute;
      top: 5px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 20px;
      opacity: 0.8;
      z-index: 2;
    }

    .header h1 {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 10px;
      text-shadow: 0 3px 10px rgba(0,0,0,0.2);
      position: relative;
      z-index: 2;
    }

    .header p {
      font-size: 16px;
      opacity: 0.95;
      position: relative;
      z-index: 2;
    }

    .content {
      padding: 30px;
    }

    .schedule-item {
      background: linear-gradient(135deg, #ffffff, #f3f4ff);
      border: 2px solid #c7d2fe;
      border-radius: 18px;
      padding: 22px;
      margin-bottom: 20px;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }

    .schedule-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
      transition: left 0.6s ease;
    }

    .schedule-item:hover::before {
      left: 100%;
    }

    .schedule-item:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 15px 40px rgba(102, 126, 234, 0.3);
      border-color: #818cf8;
    }

    .schedule-item h3 {
      color: #5b21b6;
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      position: relative;
      z-index: 1;
    }

    .movie-options {
      display: grid;
      gap: 15px;
      margin: 20px 0;
    }

    .movie-card {
      background: linear-gradient(135deg, #ffffff, #ede9fe);
      border: 2px solid #c7d2fe;
      border-radius: 15px;
      padding: 18px;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }

    .movie-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.2), transparent);
      transition: left 0.6s ease;
    }

    .movie-card:hover::before {
      left: 100%;
    }

    .movie-card:hover {
      transform: scale(1.05) translateY(-3px);
      border-color: #818cf8;
      box-shadow: 0 12px 30px rgba(102, 126, 234, 0.35);
    }

    .movie-card:active {
      transform: scale(0.98);
      transition: all 0.1s ease;
    }

    .movie-card.selected {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-color: #5b21b6;
      transform: scale(1.03);
      animation: selectedPulse 2s ease-in-out infinite;
    }

    @keyframes selectedPulse {
      0%, 100% { box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4); }
      50% { box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6); }
    }

    .movie-title {
      font-weight: 600;
      font-size: 16px;
      margin-bottom: 8px;
    }

    .movie-info {
      font-size: 14px;
      opacity: 0.8;
      line-height: 1.4;
    }

    .movie-card.selected .movie-info {
      opacity: 0.9;
    }

    .submit-btn {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 16px 35px;
      border-radius: 30px;
      font-size: 17px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      width: 100%;
      margin-top: 20px;
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
      position: relative;
      overflow: hidden;
    }

    .submit-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s ease, height 0.6s ease;
    }

    .submit-btn:hover::before {
      width: 300px;
      height: 300px;
    }

    .submit-btn:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: 0 12px 35px rgba(102, 126, 234, 0.5);
    }

    .submit-btn:active {
      transform: translateY(-1px) scale(0.98);
      transition: all 0.1s ease;
    }

    .submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
    }

    .submit-btn:disabled:hover {
      transform: none;
    }

    .cute-emoji {
      display: inline-block;
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% {
        transform: translateY(0);
      }
      40% {
        transform: translateY(-5px);
      }
      60% {
        transform: translateY(-3px);
      }
    }

    .success-message {
      background: linear-gradient(135deg, #fbcfe8, #e9d5ff);
      color: #86198f;
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      font-weight: 600;
      margin-top: 20px;
      display: none;
      border: 2px solid #ec4899;
    }

    .nicknames {
      font-size: 14px;
      opacity: 0.8;
      margin-top: 10px;
      font-style: italic;
    }

    .music-controls {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid #fbcfe8;
      border-radius: 50px;
      padding: 10px 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      backdrop-filter: blur(10px);
      box-shadow: 0 5px 15px rgba(190, 24, 93, 0.2);
      z-index: 1000;
      cursor: grab;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }

    .music-controls:active {
      cursor: grabbing;
    }

    .music-controls.dragging {
      cursor: grabbing;
      transform: scale(1.05);
      box-shadow: 0 10px 30px rgba(190, 24, 93, 0.4);
      background: rgba(255, 255, 255, 0.95);
      transition: none;
    }

    .music-btn {
      background: linear-gradient(135deg, #a855f7, #ec4899);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      /* Remove mobile tap highlights */
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      outline: none;
    }

    .music-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 5px 15px rgba(190, 24, 93, 0.3);
    }

    .music-btn:focus {
      outline: none;
    }

    .music-btn:active {
      outline: none;
      -webkit-tap-highlight-color: transparent;
    }

    .music-info {
      font-size: 12px;
      color: #a21caf;
      font-weight: 600;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .playing {
      animation: pulse 2s infinite;
    }

    /* Runaway button styles */
    .button-container {
      display: flex;
      gap: 15px;
      margin-top: 25px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .reject-btn {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      color: white;
      border: none;
      padding: 14px 28px;
      border-radius: 30px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 18px rgba(239, 68, 68, 0.4);
      position: fixed;
      z-index: 999;
    }

    .reject-btn:hover {
      transform: scale(0.95);
      box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    }

    .reject-btn.shrinking {
      animation: shrinkAway 1.5s ease-out forwards;
    }

    @keyframes shrinkAway {
      0% {
        opacity: 1;
        transform: scale(1);
      }
      70% {
        opacity: 0.5;
        transform: scale(0.3);
      }
      100% {
        opacity: 0;
        transform: scale(0);
        display: none;
      }
    }

    .accept-btn {
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      border: none;
      padding: 14px 28px;
      border-radius: 30px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      box-shadow: 0 6px 18px rgba(16, 185, 129, 0.4);
      position: relative;
      overflow: hidden;
    }

    .accept-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s ease, height 0.6s ease;
    }

    .accept-btn:hover::before {
      width: 300px;
      height: 300px;
    }

    .accept-btn:hover {
      transform: translateY(-4px) scale(1.08);
      box-shadow: 0 10px 30px rgba(16, 185, 129, 0.5);
    }

    .accept-btn:active {
      transform: scale(0.95);
    }

    /* Interactive quiz section */
    .quiz-section {
      background: linear-gradient(135deg, #fef3c7, #fde68a);
      border: 2px solid #fbbf24;
      border-radius: 18px;
      padding: 25px;
      margin-top: 25px;
      position: relative;
      overflow: hidden;
    }

    .quiz-section::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, transparent 70%);
      animation: quizGlow 10s ease-in-out infinite;
    }

    @keyframes quizGlow {
      0%, 100% { transform: translate(0, 0) rotate(0deg); }
      50% { transform: translate(-10%, -10%) rotate(180deg); }
    }

    .quiz-section h3 {
      color: #92400e;
      font-size: 19px;
      font-weight: 700;
      margin-bottom: 18px;
      position: relative;
      z-index: 1;
    }

    .quiz-option {
      background: white;
      border: 2px solid #fbbf24;
      border-radius: 12px;
      padding: 12px 18px;
      margin: 10px 0;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      z-index: 1;
    }

    .quiz-option:hover {
      transform: translateX(10px) scale(1.02);
      background: #fffbeb;
      border-color: #f59e0b;
      box-shadow: 0 5px 15px rgba(245, 158, 11, 0.3);
    }

    .quiz-option.correct {
      background: linear-gradient(135deg, #86efac, #4ade80);
      border-color: #16a34a;
      color: #14532d;
      font-weight: 600;
      animation: correctAnswer 0.6s ease;
    }

    .quiz-option.wrong {
      background: linear-gradient(135deg, #fca5a5, #f87171);
      border-color: #dc2626;
      color: #7f1d1d;
      animation: shake 0.5s ease;
    }

    @keyframes correctAnswer {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    /* Modern Message Box */
    .message-box {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      background: white;
      border-radius: 20px;
      padding: 30px 40px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      z-index: 10000;
      max-width: 400px;
      text-align: center;
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .message-box.show {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }

    .message-box-content {
      font-size: 18px;
      color: #333;
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .message-box-button {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .message-box-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.5);
    }

    .message-box-button:active {
      transform: translateY(0);
    }

    .message-box-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9999;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    .message-box-overlay.show {
      opacity: 1;
      pointer-events: auto;
    }
  </style>
</head>
<body>
    <!-- Message Box Overlay -->
    <div class="message-box-overlay" id="messageOverlay"></div>

    <!-- Message Box -->
    <div class="message-box" id="messageBox">
      <div class="message-box-content" id="messageContent"></div>
      <button class="message-box-button" id="messageButton">OK</button>
    </div>

    <!-- Music Controls -->
    <div class="music-controls">
        <button class="music-btn" id="musicBtn">üéµ</button>
        <div class="music-info">
            <div>V∆∞·ªùn M√¢y V·ª´a Hay</div>
            <div style="font-size: 10px; opacity: 0.7;">Click ƒë·ªÉ ph√°t nh·∫°c</div>
        </div>
    </div>
    
    <!-- Audio with local file -->
    <audio id="backgroundMusic" loop>
        <source src="https://res.cloudinary.com/daartoyul/video/upload/v1759043721/vuon_may_vua_hay_ktd9jb.mp3" type="audio/mpeg">
    </audio>

    <div class="container">
        <div class="header">
            <h1>L·ªãch tr√¨nh ƒëi ch∆°i c·ªßa ch√∫ng ta <span class="cute-emoji">üíï</span></h1>
            <p>H√£y ch·ªçn phim em mu·ªën xem nh√©!</p>
            <div class="nicknames">
                D√†nh cho d√¢n ch∆°i aka em b√© aka em nh·ªè aka kf c·ªßa toi <span class="cute-emoji">üêøÔ∏è</span>
            </div>
        </div>
        
        <div class="content">
            <div class="schedule-item">
                <h3><span class="cute-emoji">üè†</span> 18h30: C√≥ m·∫∑t t·∫°i nh√† em p√©</h3>
                <p style="color: #666; margin-left: 35px;">ƒê√∫ng gi·ªù nh√©, ƒë·ª´ng ƒë·ªÉ em p√© ƒë·ª£i! <span class="cute-emoji">‚è∞</span></p>
            </div>
            
            <div class="schedule-item">
                <h3><span class="cute-emoji">üé¨</span> ƒêi xem phim</h3>
                <p style="color: #666; margin-bottom: 15px;">Ch·ªçn phim em mu·ªën xem nha:</p>
                
                <div class="movie-options">
                    <div class="movie-card" data-movie="ƒê·ªìi H√†nh X√°c">
                        <div class="movie-title">üßü Phim "ƒê·ªìi H√†nh X√°c"</div>
                        <div class="movie-info">üìç CGV Th·∫£o ƒêi·ªÅn Pearl<br>‚è∞ 18:05 chi·∫øu</div>
                    </div>
                    
                    <div class="movie-card" data-movie="EXIT 8: GA T√ÄU V√î T·∫¨N">
                        <div class="movie-title">üöÇ Phim "EXIT 8: GA T√ÄU V√î T·∫¨N"</div>
                        <div class="movie-info">üìç CGV Menas Mall (CGV CT Plaza)<br>‚è∞ 18:00 chi·∫øu</div>
                    </div>
                    
                    <div class="movie-card" data-movie="The Conjuring">
                        <div class="movie-title">üëª Phim "The Conjuring"</div>
                        <div class="movie-info">üìç CGV Gigamall Th·ªß ƒê·ª©c<br>‚è∞ 17:40 chi·∫øu<br>üí° 17h15 c√≥ m·∫∑t t·∫°i nh√† em p√©</div>
                    </div>
                    
                    <div class="movie-card" data-movie="L√†m Gi√†u V·ªõi Ma">
                        <div class="movie-title">üí∞ Phim "L√†m Gi√†u V·ªõi Ma"</div>
                        <div class="movie-info">üìç CGV Pandora City<br>‚è∞ 17:50 chi·∫øu<br>üí° 17h15 c√≥ m·∫∑t t·∫°i nh√† em p√©</div>
                    </div>
                </div>
            </div>
            
            <div class="schedule-item">
                <h3><span class="cute-emoji">üçó</span> ƒê·∫øn Ti·ªám G√† Bok Bok mua g√†</h3>
                <p style="color: #666; margin-left: 35px;">ƒÇn g√† gi√≤n ngon sau phim! <span class="cute-emoji">üòã</span></p>
            </div>
            
            <div class="schedule-item">
                <h3><span class="cute-emoji">üå∏</span> ƒêi d·∫°o ·ªü C√¥ng Vi√™n S√°ng T·∫°o</h3>
                <p style="color: #666; margin-left: 35px;">Chill c√πng nhau d∆∞·ªõi √°nh ƒë√®n! <span class="cute-emoji">üåô</span></p>
            </div>
            
            <button class="submit-btn" id="submitBtn" disabled>
                G·ª≠i l·ª±a ch·ªçn c·ªßa em p√© <span class="cute-emoji">üíå</span>
            </button>

            <div class="success-message" id="successMessage">
                <span class="cute-emoji">üéâ</span> Email ƒë√£ t·ª± ƒë·ªông g·ª≠i t·ª´ hytaty@gmail.com ƒë·∫øn huynhtranty@gmail.com th√†nh c√¥ng! <span class="cute-emoji">üíï</span>
                <div style="font-size: 12px; margin-top: 10px; opacity: 0.8;">
                    üìß Ki·ªÉm tra h·ªôp th∆∞ ƒë·∫øn c·ªßa huynhtranty@gmail.com nh√©!
                </div>
            </div>

            <!-- Interactive Quiz Section -->
            <div class="quiz-section" id="quizSection">
                <h3>üéØ C√¢u h·ªèi vui: Em c√≥ mu·ªën ƒëi ch∆°i kh√¥ng? üíï</h3>
                <div class="quiz-option" data-answer="correct">
                    ‚ú® C√≥ ch·ª©! ƒêi li·ªÅn! üòç
                </div>
                <div class="quiz-option" data-answer="correct">
                    üíñ T·∫•t nhi√™n r·ªìi! Em ƒëang mong ch·ªù l·∫Øm!
                </div>
                <div class="quiz-option" data-answer="correct">
                    üåü Ch·∫Øc ch·∫Øn lu√¥n! Let's go! üöÄ
                </div>
                <div class="quiz-option" data-answer="wrong">
                    üò¢ H√¥√¥n·ªïng dƒëi...
                </div>
            </div>

            <!-- Yes/No Buttons -->
            <div class="schedule-item" style="margin-top: 25px; text-align: center;">
                <h3 style="justify-content: center;">üíù Em c√≥ mu·ªën ƒëi xem phim v·ªõi anh kh√¥ng?</h3>
                <div class="button-container">
                    <button class="accept-btn" id="acceptBtn">
                        C√≥! Em mu·ªën l·∫Øm! üíï
                    </button>
                    <button class="reject-btn" id="rejectBtn">
                        H√¥√¥n·ªïng dƒëi üò¢
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let selectedMovie = null;
        let isPlaying = false;
        const music = document.getElementById('backgroundMusic');
        const musicBtn = document.getElementById('musicBtn');

        // Modern Message Box Function
        function showMessage(message) {
            const messageBox = document.getElementById('messageBox');
            const messageOverlay = document.getElementById('messageOverlay');
            const messageContent = document.getElementById('messageContent');
            const messageButton = document.getElementById('messageButton');

            messageContent.innerHTML = message;
            messageOverlay.classList.add('show');
            messageBox.classList.add('show');

            // Close on button click
            messageButton.onclick = function() {
                messageBox.classList.remove('show');
                messageOverlay.classList.remove('show');
            };

            // Close on overlay click
            messageOverlay.onclick = function() {
                messageBox.classList.remove('show');
                messageOverlay.classList.remove('show');
            };
        }
        
        // Dragging variables
        let isDragging = false;
        let dragOffset = { x: 0, y: 0 };
        const musicControls = document.querySelector('.music-controls');
        
        // Make music controls draggable
        function initDragging() {
            let dragStartTime = 0;
            let hasMoved = false;
            let dragThreshold = 5; // pixels
            let startPos = { x: 0, y: 0 };
            
            // Mouse events
            musicControls.addEventListener('mousedown', startDrag);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', endDrag);
            
            // Touch events
            musicControls.addEventListener('touchstart', startDragTouch, { passive: false });
            document.addEventListener('touchmove', dragTouch, { passive: false });
            document.addEventListener('touchend', endDrag);
            
            function startDrag(e) {
                // Don't start drag if clicking on the music button itself
                if (e.target.closest('.music-btn')) {
                    return;
                }
                
                dragStartTime = Date.now();
                hasMoved = false;
                startPos.x = e.clientX;
                startPos.y = e.clientY;
                
                const rect = musicControls.getBoundingClientRect();
                dragOffset.x = e.clientX - rect.left;
                dragOffset.y = e.clientY - rect.top;
            }
            
            function startDragTouch(e) {
                if (e.touches.length === 1) {
                    const touch = e.touches[0];
                    
                    // Don't start drag if touching the music button itself
                    if (e.target.closest('.music-btn')) {
                        return;
                    }
                    
                    dragStartTime = Date.now();
                    hasMoved = false;
                    startPos.x = touch.clientX;
                    startPos.y = touch.clientY;
                    
                    const rect = musicControls.getBoundingClientRect();
                    dragOffset.x = touch.clientX - rect.left;
                    dragOffset.y = touch.clientY - rect.top;
                }
            }
            
            function drag(e) {
                if (dragStartTime === 0) return;
                
                const currentX = e.clientX;
                const currentY = e.clientY;
                const distance = Math.sqrt(
                    Math.pow(currentX - startPos.x, 2) + Math.pow(currentY - startPos.y, 2)
                );
                
                if (distance > dragThreshold && !isDragging) {
                    isDragging = true;
                    hasMoved = true;
                    musicControls.classList.add('dragging');
                }
                
                if (isDragging) {
                    moveElement(currentX, currentY);
                    e.preventDefault();
                }
            }
            
            function dragTouch(e) {
                if (dragStartTime === 0 || e.touches.length !== 1) return;
                
                const touch = e.touches[0];
                const currentX = touch.clientX;
                const currentY = touch.clientY;
                const distance = Math.sqrt(
                    Math.pow(currentX - startPos.x, 2) + Math.pow(currentY - startPos.y, 2)
                );
                
                if (distance > dragThreshold && !isDragging) {
                    isDragging = true;
                    hasMoved = true;
                    musicControls.classList.add('dragging');
                }
                
                if (isDragging) {
                    moveElement(currentX, currentY);
                    e.preventDefault();
                }
            }
            
            function moveElement(clientX, clientY) {
                const windowWidth = window.innerWidth;
                const windowHeight = window.innerHeight;
                const elementWidth = musicControls.offsetWidth;
                const elementHeight = musicControls.offsetHeight;
                
                // Calculate new position
                let newX = clientX - dragOffset.x;
                let newY = clientY - dragOffset.y;
                
                // Boundary checking
                newX = Math.max(0, Math.min(newX, windowWidth - elementWidth));
                newY = Math.max(0, Math.min(newY, windowHeight - elementHeight));
                
                // Apply position
                musicControls.style.left = newX + 'px';
                musicControls.style.top = newY + 'px';
                musicControls.style.right = 'auto';
                musicControls.style.bottom = 'auto';
            }
            
            function endDrag(e) {
                if (isDragging) {
                    isDragging = false;
                    musicControls.classList.remove('dragging');
                    
                    // Prevent click event if we actually dragged
                    if (hasMoved) {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                }
                
                dragStartTime = 0;
                hasMoved = false;
            }
        }
        
        // Initialize dragging when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initDragging();
            
            // Initialize music control after DOM is loaded
            initMusicControl();
        });
        
        // Music control
        function initMusicControl() {
            musicBtn.addEventListener('click', function(e) {
                // Prevent event bubbling to parent elements
                e.stopPropagation();
                
                // Only handle click if we're not in the middle of dragging
                if (isDragging) {
                    return;
                }
            if (isPlaying) {
                music.pause();
                musicBtn.innerHTML = 'üéµ';
                musicBtn.classList.remove('playing');
                document.querySelector('.music-info div:last-child').textContent = 'Click ƒë·ªÉ ph√°t nh·∫°c';
                isPlaying = false;
            } else {
                music.play().then(() => {
                    musicBtn.innerHTML = 'üé∂';
                    musicBtn.classList.add('playing');
                    document.querySelector('.music-info div:last-child').textContent = 'ƒêang ph√°t...';
                    isPlaying = true;
                }).catch(error => {
                    console.log('Cannot play audio:', error);
                    // Fallback to romantic ambiance
                    playRomanticAmbiance();
                    musicBtn.innerHTML = 'üé∂';
                    musicBtn.classList.add('playing');
                    document.querySelector('.music-info div:last-child').textContent = 'ƒêang ph√°t...';
                    isPlaying = true;
                });
            }
        });
        }
        
        function playRomanticAmbiance() {
            // Gentle romantic melody as fallback if file doesn't load
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                function playNote(frequency, startTime, duration) {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(frequency, startTime);
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0, startTime);
                    gainNode.gain.linearRampToValueAtTime(0.05, startTime + 0.1);
                    gainNode.gain.linearRampToValueAtTime(0, startTime + duration);
                    
                    oscillator.start(startTime);
                    oscillator.stop(startTime + duration);
                }
                
                const melody = [523.25, 587.33, 659.25, 698.46, 783.99];
                let time = audioContext.currentTime;
                
                function playMelody() {
                    if (isPlaying) {
                        melody.forEach((note, index) => {
                            playNote(note, time + index * 0.8, 1.2);
                        });
                        time += 4;
                        setTimeout(playMelody, 4000);
                    }
                }
                
                playMelody();
            } catch (error) {
                console.log('Audio context not supported');
            }
        }
        
        // Handle movie selection
        document.querySelectorAll('.movie-card').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.movie-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                selectedMovie = this.dataset.movie;
                document.getElementById('submitBtn').disabled = false;
            });
        });

        // Quiz interaction
        document.querySelectorAll('.quiz-option').forEach(option => {
            option.addEventListener('click', function() {
                const isCorrect = this.dataset.answer === 'correct';

                // Remove previous states
                document.querySelectorAll('.quiz-option').forEach(opt => {
                    opt.classList.remove('correct', 'wrong');
                    opt.style.pointerEvents = 'auto';
                });

                if (isCorrect) {
                    this.classList.add('correct');
                    setTimeout(() => {
                        showMessage('ƒê√∫ng r·ªìi! Em gi·ªèi qu√°! üéâüíï');
                    }, 300);
                } else {
                    this.classList.add('wrong');
                    setTimeout(() => {
                        showMessage('∆† k√¨a! Ch·ªçn l·∫°i ƒëi em! üòÑüíñ');
                        this.classList.remove('wrong');
                    }, 500);
                }
            });
        });

        // Runaway button logic
        const rejectBtn = document.getElementById('rejectBtn');
        const acceptBtn = document.getElementById('acceptBtn');
        let clickCount = 0;
        const maxClicks = 10;

        function getRandomPosition() {
            const btnRect = rejectBtn.getBoundingClientRect();

            const maxX = window.innerWidth - btnRect.width - 40;
            const maxY = window.innerHeight - btnRect.height - 40;

            const x = Math.max(20, Math.random() * maxX);
            const y = Math.max(20, Math.random() * maxY);

            return { x, y };
        }

        // Initialize reject button position
        window.addEventListener('DOMContentLoaded', function() {
            const btnRect = rejectBtn.getBoundingClientRect();
            rejectBtn.style.left = (btnRect.left) + 'px';
            rejectBtn.style.top = (btnRect.top) + 'px';
        });

        // Handle reject button click/hover
        rejectBtn.addEventListener('click', function(e) {
            e.preventDefault();

            if (clickCount >= maxClicks) {
                rejectBtn.classList.add('shrinking');
                setTimeout(() => {
                    rejectBtn.remove();
                    showMessage('Haha! N√∫t "Kh√¥ng" ƒë√£ bi·∫øn m·∫•t r·ªìi! üòÑüíï<br>Em ph·∫£i ƒë·ªìng √Ω th√¥i!');
                }, 1500);
                return;
            }

            const pos = getRandomPosition();
            rejectBtn.style.left = pos.x + 'px';
            rejectBtn.style.top = pos.y + 'px';

            clickCount++;

            // Shrink the button gradually (10% each click)
            const newScale = Math.max(0.2, 1 - (clickCount * 0.08));
            rejectBtn.style.transform = `scale(${newScale})`;
        });

        // Also move on hover for extra fun
        rejectBtn.addEventListener('mouseenter', function() {
            if (clickCount < maxClicks && clickCount > 0) {
                const pos = getRandomPosition();
                rejectBtn.style.left = pos.x + 'px';
                rejectBtn.style.top = pos.y + 'px';
            }
        });

        // Accept button action
        acceptBtn.addEventListener('click', function() {
            const messages = [
                'Yay! Em ƒë·ªìng √Ω r·ªìi! üéâüíï',
                'Anh bi·∫øt m√†! Em y√™u anh nh·∫•t! üòòüíñ',
                'Tuy·ªát v·ªùi! H·∫πn g·∫∑p em nh√©! üåüüíù',
                'Em l√† ng∆∞·ªùi tuy·ªát v·ªùi nh·∫•t! üíï‚ú®'
            ];
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];

            // Celebration effect
            this.innerHTML = 'üéä Yay! üéä';
            setTimeout(() => {
                showMessage(randomMessage);
                this.innerHTML = 'C√≥! Em mu·ªën l·∫Øm! üíï';
            }, 500);
        });
        
        // Handle form submission with Web3Forms
        document.getElementById('submitBtn').addEventListener('click', async function() {
            if (!selectedMovie) return;
            
            // Disable button and show loading
            this.disabled = true;
            this.innerHTML = 'ƒêang g·ª≠i... <span class="cute-emoji">‚è≥</span>';
            
            const emailData = {
                access_key: "1097c6ec-aaff-43da-bfb2-9cc6cce5979b", // Thay b·∫±ng key m·ªõi t·ª´ web3forms.com
                subject: "Em p√© ƒë√£ ch·ªçn phim r·ªìi! üé¨üíï",
                from_name: "D√¢n ch∆°i aka em p√© aka b√© nh·ªè aka tv",
                from_email: "hytaty2109@gmail.com",
                to_email: "huynhtranty@gmail.com",
                message: `C·∫£m ∆°n Vy nh√¨uuuu! üíï

Kafea c·ªßa T ƒë√£ ch·ªçn phim r·ªìi nh√©:

üé¨ Phim ƒë√£ ch·ªçn: ${selectedMovie}

H·∫πn g·∫∑p T ƒë√∫ng gi·ªù nha! 

---
G·ª≠i t·ª´ website cute c·ªßa Ty l√†m üòò`
            };
            
            try {
                console.log('ƒêang g·ª≠i email...', emailData);
                
                const response = await fetch('https://api.web3forms.com/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(emailData)
                });
                
                console.log('Response status:', response.status);
                const result = await response.json();
                console.log('Response result:', result);
                
                if (result.success) {
                    document.getElementById('successMessage').style.display = 'block';
                    this.innerHTML = 'ƒê√£ g·ª≠i th√†nh c√¥ng! <span class="cute-emoji">‚ú®</span>';
                } else {
                    console.error('Web3Forms error:', result.message);
                    throw new Error(`Web3Forms failed: ${result.message || 'Unknown error'}`);
                }
            } catch (error) {
                console.error('Email sending failed:', error);
                alert(`L·ªói g·ª≠i email: ${error.message}. S·∫Ω chuy·ªÉn sang mailto...`);
                
                // Fallback to mailto if auto-send fails
                const subject = encodeURIComponent('Em p√© ƒë√£ ch·ªçn phim r·ªìi! üé¨üíï');
                const body = encodeURIComponent(emailData.message);
                const mailtoLink = `mailto:huynhtranty@gmail.com?subject=${subject}&body=${body}`;
                window.location.href = mailtoLink;
                
                this.innerHTML = 'M·ªü email ƒë·ªÉ g·ª≠i <span class="cute-emoji">üìß</span>';
                this.disabled = false;
            }
        });
    </script>
</body>
</html>
